"use strict";var Pe=Object.defineProperty,Le=Object.defineProperties,We=Object.getOwnPropertyDescriptors,z=Object.getOwnPropertySymbols,je=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable,$=(d,u,s)=>u in d?Pe(d,u,{enumerable:!0,configurable:!0,writable:!0,value:s}):d[u]=s,K=(d,u)=>{for(var s in u||(u={}))je.call(u,s)&&$(d,s,u[s]);if(z)for(var s of z(u))ze.call(u,s)&&$(d,s,u[s]);return d},G=(d,u)=>Le(d,We(u));(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[445],{9445:(d,u,s)=>{s.r(u),s.d(u,{ChatModule:()=>Re});var h=s(3507),v=s(86),X=s(904),C=s(8167),k=s(9112),J=s(4383),b=s(3530),T=s(7891),V=s(1382),q=s(8100),Z=s(2035),t=s(3668),w=s(4499),y=s(7384),D=s(4753),Q=s(3067),tt=s(9433),et=s(2997),O=s(9468),nt=s(461),ot=s(4522);let _=(()=>{class n{constructor(e){this._httpClient=e,this._chat=new w.X(null),this._chats=new w.X(null),this._contact=new w.X(null),this._contacts=new w.X(null),this._profile=new w.X(null)}get chat$(){return this._chat.asObservable()}get chats$(){return this._chats.asObservable()}get contact$(){return this._contact.asObservable()}get contacts$(){return this._contacts.asObservable()}get profile$(){return this._profile.asObservable()}getChats(){return this._httpClient.get("api/apps/chat/chats").pipe((0,y.b)(e=>{this._chats.next(e)}))}getContact(e){return this._httpClient.get("api/apps/chat/contacts",{params:{id:e}}).pipe((0,y.b)(i=>{this._contact.next(i)}))}getContacts(){return this._httpClient.get("api/apps/chat/contacts").pipe((0,y.b)(e=>{this._contacts.next(e)}))}getProfile(){return this._httpClient.get("api/apps/chat/profile").pipe((0,y.b)(e=>{this._profile.next(e)}))}getChatById(e){return this._httpClient.get("api/apps/chat/chat",{params:{id:e}}).pipe((0,D.U)(i=>(this._chat.next(i),i)),(0,Q.w)(i=>i?(0,et.of)(i):(0,tt._)("Could not found chat with id of "+e+"!")))}updateChat(e,i){return this.chats$.pipe((0,O.q)(1),(0,Q.w)(r=>this._httpClient.patch("api/apps/chat/chat",{id:e,chat:i}).pipe((0,D.U)(c=>{const a=r.findIndex(l=>l.id===e);return r[a]=c,this._chats.next(r),c}),(0,Q.w)(c=>this.chat$.pipe((0,O.q)(1),(0,nt.h)(a=>a&&a.id===e),(0,y.b)(()=>(this._chat.next(c),c)))))))}resetChat(){this._chat.next(null)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(ot.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var S=s(3549),U=s(9260),x=s(9007);let it=(()=>{class n{constructor(e,i,r,c,a){this._chatService=e,this._ticketService=i,this._userService=r,this._router=c,this.store=a}resolve(e,i){let r=this._userService.accessUser;return console.log(r.queues.map(c=>c.id)),(0,q.D)([this.store.dispatch((0,Z.fY)({payload:{pageNumber:1,status:"open",showAll:!0,queueIds:[r.queues.map(c=>c.id)]}}))],[this.store.dispatch((0,Z.fY)({payload:{pageNumber:1,status:"pending",showAll:!1,queueIds:[r.queues.map(c=>c.id)]}}))])}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(_),t.LFG(S.w),t.LFG(U.K),t.LFG(h.F0),t.LFG(x.yh))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),rt=(()=>{class n{constructor(e,i,r,c){this._chatService=e,this._ticketService=i,this.store=r,this._router=c}resolve(e,i){return(0,q.D)([this.store.dispatch((0,Z.TB)())],[this.store.dispatch((0,Z.EV)({id:e.paramMap.get("id"),payload:{pageNumber:1}}))])}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(_),t.LFG(S.w),t.LFG(x.yh),t.LFG(h.F0))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ct=(()=>{class n{constructor(e,i){this._chatService=e,this._router=i}resolve(e,i){return this._chatService.getContacts()}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(_),t.LFG(h.F0))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),st=(()=>{class n{constructor(e,i){this._chatService=e,this._router=i}resolve(e,i){return this._chatService.getProfile()}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(_),t.LFG(h.F0))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),at=(()=>{class n{constructor(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["chat"]],decls:3,vars:0,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden"],[1,"flex","flex-auto","overflow-hidden"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t._UZ(2,"router-outlet"),t.qZA(),t.qZA())},directives:[h.lC],encapsulation:2,changeDetection:0}),n})();var lt=s(8239),A=s(273),f=s(6263);const M=n=>n.tickets,B=((0,x.P1)(M,n=>n.tickets),n=>(0,x.P1)(M,o=>o.tickets.filter(e=>e.status==n))),ut=(0,x.P1)(M,n=>n.messages.slice().sort(function(o,e){return Number(new Date(o.createdAt))-Number(new Date(e.createdAt))}));var pt=s(8394),Y=s(2179),gt=s(6303),p=s(6019);function ft(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",15),t._uU(2),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(2),t.hij(" ",e.name.charAt(0)," ")}}function dt(n,o){if(1&n&&(t.ynx(0),t._UZ(1,"img",16),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("src",e.avatar,t.LSH)}}function ht(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",17),t._uU(2),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(2),t.hij(" ",e.name.charAt(0)," ")}}function mt(n,o){if(1&n&&(t.ynx(0),t.YNc(1,ft,3,1,"ng-container",9),t.TgZ(2,"div",10),t.TgZ(3,"div",11),t.YNc(4,dt,2,1,"ng-container",9),t.YNc(5,ht,3,1,"ng-container",9),t.qZA(),t.TgZ(6,"div",12),t.TgZ(7,"div",13),t._uU(8),t.qZA(),t.TgZ(9,"div",14),t._uU(10),t.qZA(),t.qZA(),t.qZA(),t.BQk()),2&n){const e=o.$implicit,i=o.index,r=t.oxw(2);t.xp6(1),t.Q6J("ngIf",0===i||e.name.charAt(0)!==r.contacts[i-1].name.charAt(0)),t.xp6(3),t.Q6J("ngIf",e.avatar),t.xp6(1),t.Q6J("ngIf",!e.avatar),t.xp6(3),t.Oqu(e.name),t.xp6(2),t.Oqu(e.about)}}function _t(n,o){if(1&n&&(t.ynx(0),t.YNc(1,mt,11,5,"ng-container",8),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.contacts)("ngForTrackBy",e.trackByFn)}}function xt(n,o){1&n&&(t.TgZ(0,"div",18),t._uU(1,"There are no contacts!"),t.qZA())}let vt=(()=>{class n{constructor(e){this._chatService=e,this.contacts=[],this._unsubscribeAll=new A.x}ngOnInit(){this._chatService.contacts$.pipe((0,f.R)(this._unsubscribeAll)).subscribe(e=>{this.contacts=e})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}trackByFn(e,i){return i.id||e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_))},n.\u0275cmp=t.Xpm({type:n,selectors:[["chat-new-chat"]],inputs:{drawer:"drawer"},decls:10,vars:3,consts:[[1,"flex","flex-col","flex-auto","h-full","overflow-hidden","bg-card","dark:bg-default"],[1,"flex","flex-0","items-center","h-18","-mb-px","px-6","bg-gray-50","dark:bg-transparent"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"ml-2","text-2xl","font-semibold"],[1,"relative","overflow-y-auto"],[4,"ngIf","ngIfElse"],["noContacts",""],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"z-20","flex","items-center","px-6","py-4","md:px-8","cursor-pointer","border-b","hover:bg-gray-100","dark:hover:bg-hover"],[1,"flex","flex-0","items-center","justify-center","w-10","h-10","rounded-full","overflow-hidden"],[1,"min-w-0","ml-4"],[1,"font-medium","leading-5","truncate"],[1,"leading-5","truncate","text-secondary"],[1,"z-10","sticky","top-0","-mt-px","px-6","py-1","md:px-8","border-t","border-b","font-medium","uppercase","text-secondary","bg-gray-100","dark:bg-gray-900"],["alt","Contact avatar",1,"object-cover","w-full","h-full",3,"src"],[1,"flex","items-center","justify-center","w-full","h-full","rounded-full","text-lg","uppercase","bg-gray-200","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],[1,"p-8","sm:p-16","border-t","text-4xl","font-semibold","tracking-tight","text-center"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"button",2),t.NdJ("click",function(){return i.drawer.close()}),t._UZ(3,"mat-icon",3),t.qZA(),t.TgZ(4,"div",4),t._uU(5,"New chat"),t.qZA(),t.qZA(),t.TgZ(6,"div",5),t.YNc(7,_t,2,2,"ng-container",6),t.qZA(),t.YNc(8,xt,2,0,"ng-template",null,7,t.W1O),t.qZA()),2&e){const r=t.MAs(9);t.xp6(3),t.Q6J("svgIcon","heroicons_outline:arrow-narrow-left"),t.xp6(4),t.Q6J("ngIf",i.contacts.length)("ngIfElse",r)}},directives:[v.lW,k.Hw,p.O5,p.sg],encapsulation:2,changeDetection:0}),n})();var F=s(9133);function Ct(n,o){if(1&n&&(t.ynx(0),t._UZ(1,"img",17),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("src",e.profile.avatar,t.LSH)("alt","Profile avatar")}}function bt(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",18),t._uU(2),t.qZA(),t.BQk()),2&n){const e=t.oxw();t.xp6(2),t.hij(" ",e.profile.name.charAt(0)," ")}}let Tt=(()=>{class n{constructor(e){this._chatService=e,this._unsubscribeAll=new A.x}ngOnInit(){this._chatService.profile$.pipe((0,f.R)(this._unsubscribeAll)).subscribe(e=>{this.profile=e})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_))},n.\u0275cmp=t.Xpm({type:n,selectors:[["chat-profile"]],inputs:{drawer:"drawer"},decls:35,vars:11,consts:[[1,"flex","flex-col","flex-auto","overflow-y-auto","bg-card","dark:bg-default"],[1,"flex","flex-0","items-center","h-18","px-6","border-b","bg-gray-50","dark:bg-transparent"],["mat-icon-button","",3,"click"],[3,"svgIcon"],[1,"ml-2","text-2xl","font-semibold"],[1,"px-6"],[1,"group","relative","flex","flex-0","mt-8","mx-auto","w-40","h-40","rounded-full"],[1,"hidden","group-hover:flex","absolute","inset-0","flex-col","items-center","justify-center","backdrop-filter","backdrop-blur","bg-opacity-80","rounded-full","cursor-pointer","bg-gray-800"],[1,"text-white",3,"svgIcon"],[1,"mt-2","mx-6","font-medium","text-center","text-white"],[4,"ngIf"],[1,"flex","flex-col","mt-8","mx-2"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"ngModel"],[1,"flex","items-center","justify-end","mt-4"],["mat-button","",3,"click"],["mat-flat-button","",1,"ml-2",3,"color"],[1,"w-full","h-full","rounded-full","object-cover",3,"src","alt"],[1,"flex","items-center","justify-center","w-full","h-full","rounded-full","text-8xl","font-semibold","uppercase","bg-gray-200","text-gray-600","dark:bg-gray-700","dark:text-gray-200"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"button",2),t.NdJ("click",function(){return i.drawer.close()}),t._UZ(3,"mat-icon",3),t.qZA(),t.TgZ(4,"div",4),t._uU(5,"Profile"),t.qZA(),t.qZA(),t.TgZ(6,"div",5),t.TgZ(7,"div",6),t.TgZ(8,"div",7),t._UZ(9,"mat-icon",8),t.TgZ(10,"div",9),t._uU(11,"Change Profile Photo"),t.qZA(),t.qZA(),t.YNc(12,Ct,2,2,"ng-container",10),t.YNc(13,bt,3,1,"ng-container",10),t.qZA(),t.TgZ(14,"div",11),t.TgZ(15,"mat-form-field"),t.TgZ(16,"mat-label"),t._uU(17,"Name"),t.qZA(),t._UZ(18,"mat-icon",12),t._UZ(19,"input",13),t.qZA(),t.TgZ(20,"mat-form-field"),t.TgZ(21,"mat-label"),t._uU(22,"Email"),t.qZA(),t._UZ(23,"mat-icon",12),t._UZ(24,"input",13),t.qZA(),t.TgZ(25,"mat-form-field"),t.TgZ(26,"mat-label"),t._uU(27,"About"),t.qZA(),t._UZ(28,"mat-icon",12),t._UZ(29,"input",13),t.qZA(),t.TgZ(30,"div",14),t.TgZ(31,"button",15),t.NdJ("click",function(){return i.drawer.close()}),t._uU(32,"Cancel "),t.qZA(),t.TgZ(33,"button",16),t._uU(34,"Save "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(3),t.Q6J("svgIcon","heroicons_outline:arrow-narrow-left"),t.xp6(6),t.Q6J("svgIcon","heroicons_outline:camera"),t.xp6(3),t.Q6J("ngIf",i.profile.avatar),t.xp6(1),t.Q6J("ngIf",!i.profile.avatar),t.xp6(5),t.Q6J("svgIcon","heroicons_solid:user-circle"),t.xp6(1),t.Q6J("ngModel",i.profile.name),t.xp6(4),t.Q6J("svgIcon","heroicons_solid:mail"),t.xp6(1),t.Q6J("ngModel",i.profile.email),t.xp6(4),t.Q6J("svgIcon","heroicons_solid:identification"),t.xp6(1),t.Q6J("ngModel",i.profile.about),t.xp6(4),t.Q6J("color","primary"))},directives:[v.lW,k.Hw,p.O5,C.KE,C.hX,C.qo,J.Nt,F.Fj,F.JJ,F.On],encapsulation:2,changeDetection:0}),n})(),Zt=(()=>{class n{constructor(e){this.eRef=e}loadFallbackOnError(){this.eRef.nativeElement.src=this.appImgFallback||"https://via.placeholder.com/200"}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.SBq))},n.\u0275dir=t.lG2({type:n,selectors:[["img","appImgFallback",""]],hostBindings:function(e,i){1&e&&t.NdJ("error",function(){return i.loadFallbackOnError()})},inputs:{appImgFallback:"appImgFallback"}}),n})();function kt(n,o){if(1&n&&(t.ynx(0),t._UZ(1,"chat-new-chat",8),t.BQk()),2&n){t.oxw();const e=t.MAs(3);t.xp6(1),t.Q6J("drawer",e)}}function wt(n,o){if(1&n&&(t.ynx(0),t._UZ(1,"chat-profile",8),t.BQk()),2&n){t.oxw();const e=t.MAs(3);t.xp6(1),t.Q6J("drawer",e)}}function yt(n,o){if(1&n&&(t.ynx(0),t._UZ(1,"img",29),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.profile.avatar,t.LSH)}}function St(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",30),t._uU(2),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.profile.name.charAt(0)," ")}}function At(n,o){if(1&n&&(t.ynx(0),t._UZ(1,"div",40),t.BQk()),2&n){const e=t.oxw().$implicit,i=t.oxw(3);t.xp6(1),t.ekj("ring-primary-50",i.selectedChat&&i.selectedChat.id===e.id)}}function It(n,o){if(1&n&&(t.ynx(0),t._UZ(1,"img",41),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("src",e.contact.profilePicUrl,t.LSH)}}function Jt(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",30),t._uU(2),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(2),t.hij(" ",e.contact.name.charAt(0)," ")}}function Mt(n,o){1&n&&(t.ynx(0),t._UZ(1,"mat-icon",42),t.BQk()),2&n&&(t.xp6(1),t.Q6J("svgIcon","heroicons_solid:volume-off"))}const Qt=function(n,o){return{"hover:bg-gray-100 dark:hover:bg-hover":n,"bg-primary-50 dark:bg-hover":o}};function Ut(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"a",32),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw(3).selectTicket(c)}),t.TgZ(2,"div",33),t.YNc(3,At,2,2,"ng-container",4),t.YNc(4,It,2,1,"ng-container",4),t.YNc(5,Jt,3,1,"ng-container",4),t.qZA(),t.TgZ(6,"div",34),t.TgZ(7,"div",35),t._uU(8),t.qZA(),t.TgZ(9,"div",36),t._uU(10),t.qZA(),t.qZA(),t.TgZ(11,"div",37),t.TgZ(12,"div",38),t._uU(13),t.ALo(14,"date"),t.qZA(),t.TgZ(15,"div",39),t._uU(16),t.qZA(),t.YNc(17,Mt,2,1,"ng-container",4),t.qZA(),t.qZA(),t.BQk()}if(2&n){const e=o.$implicit,i=t.oxw(3);t.xp6(1),t.Q6J("ngClass",t.WLB(16,Qt,!i.selectedChat||i.selectedChat.id!==e.id,i.selectedChat&&i.selectedChat.id===e.id)),t.xp6(2),t.Q6J("ngIf",e.unreadMessages>0),t.xp6(1),t.Q6J("ngIf",null==e||null==e.contact?null:e.contact.profilePicUrl),t.xp6(1),t.Q6J("ngIf",!e.contact.profilePicUrl),t.xp6(3),t.Oqu(e.contact.name),t.xp6(1),t.ekj("text-primary",e.unreadMessages>0)("dark:text-primary-500",e.unreadMessages>0),t.xp6(1),t.hij(" ",e.lastMessage," "),t.xp6(3),t.Oqu(t.xi3(14,13,e.createdAt,"dd/MM/yyyy")),t.xp6(3),t.hij(" ",e.whatsapp.name," "),t.xp6(1),t.Q6J("ngIf",e.muted)}}function Ft(n,o){if(1&n&&(t.ynx(0),t.YNc(1,Ut,18,19,"ng-container",31),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.tickets)("ngForTrackBy",e.trackByFn)}}const H=function(n,o){return{"bg-card pointer-events-none shadow":n,"bg-transparent":o}};function Nt(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",9),t.TgZ(2,"div",10),t.TgZ(3,"div",11),t.TgZ(4,"div",12),t.NdJ("click",function(){return t.CHM(e),t.oxw().openProfile()}),t.TgZ(5,"div",13),t.YNc(6,yt,2,1,"ng-container",4),t.YNc(7,St,3,1,"ng-container",4),t.qZA(),t.TgZ(8,"div",14),t._uU(9),t.qZA(),t.qZA(),t.TgZ(10,"button",15),t.NdJ("click",function(){return t.CHM(e),t.oxw().openNewChat()}),t._UZ(11,"mat-icon",16),t.qZA(),t.TgZ(12,"button",17),t._UZ(13,"mat-icon",16),t.TgZ(14,"mat-menu",null,18),t.TgZ(16,"button",19),t._UZ(17,"mat-icon",16),t._uU(18," New group "),t.qZA(),t.TgZ(19,"button",19),t._UZ(20,"mat-icon",16),t._uU(21," Create a room "),t.qZA(),t.TgZ(22,"button",20),t.NdJ("click",function(){return t.CHM(e),t.oxw().openProfile()}),t._UZ(23,"mat-icon",16),t._uU(24," Profile "),t.qZA(),t.TgZ(25,"button",19),t._UZ(26,"mat-icon",16),t._uU(27," Archived "),t.qZA(),t.TgZ(28,"button",19),t._UZ(29,"mat-icon",16),t._uU(30," Starred "),t.qZA(),t.TgZ(31,"button",19),t._UZ(32,"mat-icon",16),t._uU(33," Settings "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(34,"div",21),t.TgZ(35,"mat-form-field",22),t._UZ(36,"mat-icon",23),t.TgZ(37,"input",24,25),t.NdJ("input",function(){t.CHM(e);const r=t.MAs(38);return t.oxw().filterChats(r.value)}),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(39,"div",26),t.TgZ(40,"div",27),t.TgZ(41,"button",28),t.NdJ("click",function(){return t.CHM(e),t.oxw().filterTicket("open")}),t._uU(42," TRABAJANDO EN "),t.qZA(),t.TgZ(43,"button",28),t.NdJ("click",function(){return t.CHM(e),t.oxw().filterTicket("pending")}),t._uU(44," COLA "),t.qZA(),t.qZA(),t.YNc(45,Ft,2,2,"ng-container",6),t.qZA(),t.qZA(),t.BQk()}if(2&n){const e=t.MAs(15),i=t.oxw(),r=t.MAs(9);t.xp6(6),t.Q6J("ngIf",i.profile.avatar),t.xp6(1),t.Q6J("ngIf",!i.profile.avatar),t.xp6(2),t.Oqu(i.profile.name),t.xp6(2),t.Q6J("svgIcon","heroicons_outline:plus-circle"),t.xp6(1),t.Q6J("matMenuTriggerFor",e),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:dots-vertical"),t.xp6(4),t.Q6J("svgIcon","heroicons_outline:user-group"),t.xp6(3),t.Q6J("svgIcon","heroicons_outline:chat-alt-2"),t.xp6(3),t.Q6J("svgIcon","heroicons_outline:user-circle"),t.xp6(3),t.Q6J("svgIcon","heroicons_outline:archive"),t.xp6(3),t.Q6J("svgIcon","heroicons_outline:star"),t.xp6(3),t.Q6J("svgIcon","heroicons_outline:cog"),t.xp6(3),t.Q6J("floatLabel","always"),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:search"),t.xp6(1),t.Q6J("autocomplete","off")("placeholder","Search or start new chat"),t.xp6(4),t.Q6J("ngClass",t.WLB(20,H,"open"===i.statu,"pending"===i.statu)),t.xp6(2),t.Q6J("ngClass",t.WLB(23,H,"pending"===i.statu,"open"===i.statu)),t.xp6(2),t.Q6J("ngIf",i.tickets.length>0)("ngIfElse",r)}}function qt(n,o){1&n&&(t.TgZ(0,"div",43),t._UZ(1,"mat-icon",44),t.TgZ(2,"div",45),t._uU(3,"No Tickets"),t.qZA(),t.qZA()),2&n&&(t.xp6(1),t.Q6J("svgIcon","heroicons_outline:chat"))}const Dt=function(n,o){return{"z-20 absolute inset-0 lg:static lg:inset-auto flex":n,"hidden lg:flex":o}};function Ot(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",46),t._UZ(2,"router-outlet"),t.qZA(),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngClass",t.WLB(1,Dt,e.selectedChat&&e.selectedChat.id,!e.selectedChat||!e.selectedChat.id))}}let Bt=(()=>{class n{constructor(e,i,r,c,a,l,m,g){this.router=e,this.store=i,this.toast=r,this.modal=c,this._userService=a,this._chatService=l,this._ticketService=m,this._changeDetectorRef=g,this.statu="open",this.tickets=[],this.drawerOpened=!1,this._unsubscribeAll=new A.x}ngOnInit(){this.store.select(B(this.statu)).subscribe(e=>{this.tickets=e,this._changeDetectorRef.markForCheck()}),this._ticketService.ticket$.pipe((0,f.R)(this._unsubscribeAll)).subscribe(e=>{console.log(e),this.selectedChat=e,this._changeDetectorRef.markForCheck()}),this._userService.user$.pipe((0,f.R)(this._unsubscribeAll)).subscribe(e=>{this.user=e}),this._chatService.chats$.pipe((0,f.R)(this._unsubscribeAll)).subscribe(e=>{this.chats=this.filteredChats=e,this._changeDetectorRef.markForCheck()}),this._chatService.profile$.pipe((0,f.R)(this._unsubscribeAll)).subscribe(e=>{this.profile=e,this._changeDetectorRef.markForCheck()}),this._chatService.chat$.pipe((0,f.R)(this._unsubscribeAll)).subscribe(e=>{console.log(e),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}selectTicket(e){var i=this;"pending"!=e.status?this.router.navigateByUrl("/chatwsp/"+e.id):this.modal.show(pt.z,{title:"Ticket",body:"\xbfEstas seguro que desea aceptar el ticket",ok:"Si",cancel:"No"}).afterClosed().subscribe(function(){var r=(0,lt.Z)(function*(c){c&&i._ticketService.putTicket(e.id,{status:"open",userId:i.user.id}).subscribe(l=>{l&&(i.filterTicket("open"),i.router.navigateByUrl("/chatwsp/"+e.id))},l=>{i.toast.open(l.Message)})});return function(c){return r.apply(this,arguments)}}())}filterTicket(e){this.store.select(B(e)).subscribe(i=>{this.tickets=i,this.statu=e,this._changeDetectorRef.markForCheck()})}openNewChat(){this.drawerComponent="new-chat",this.drawerOpened=!0,this._changeDetectorRef.markForCheck()}openProfile(){this.drawerComponent="profile",this.drawerOpened=!0,this._changeDetectorRef.markForCheck()}trackByFn(e,i){return i.id||e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h.F0),t.Y36(x.yh),t.Y36(Y.F),t.Y36(gt.u),t.Y36(U.K),t.Y36(_),t.Y36(S.w),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["chat-chats"]],decls:11,vars:8,consts:[[1,"relative","flex","flex-auto","w-full","bg-card","dark:bg-transparent"],[1,"flex-auto","h-full",3,"hasBackdrop"],[1,"w-full","sm:w-100","lg:border-r","lg:shadow-none","dark:bg-gray-900",3,"autoFocus","opened","openedChange"],["drawer",""],[4,"ngIf"],[1,"flex","overflow-hidden"],[4,"ngIf","ngIfElse"],["noChats",""],[3,"drawer"],[1,"relative","flex","flex-auto","flex-col","w-full","min-w-0","lg:min-w-100","lg:max-w-100","bg-card","dark:bg-transparent"],[1,"flex","flex-col","flex-0","py-4","px-8","border-b","bg-gray-50","dark:bg-transparent"],[1,"flex","items-center"],[1,"flex","items-center","mr-1","cursor-pointer",3,"click"],[1,"w-10","h-10"],[1,"ml-4","font-medium","truncate"],["mat-icon-button","",1,"ml-auto",3,"click"],[3,"svgIcon"],["mat-icon-button","",1,"ml-1","-mr-4",3,"matMenuTriggerFor"],["chatsHeaderMenu",""],["mat-menu-item",""],["mat-menu-item","",3,"click"],[1,"mt-4"],[1,"fuse-mat-no-subscript","fuse-mat-rounded","fuse-mat-dense","w-full",3,"floatLabel"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"autocomplete","placeholder","input"],["searchField",""],[1,"flex-auto","overflow-y-auto"],[1,"flex","items-center","p-0.5","overflow-hidden","bg-gray-200","dark:bg-gray-700"],["mat-flat-button","","disableRipple","",1,"w-full",3,"ngClass","click"],["alt","Profile avatar",1,"object-cover","w-full","h-full","rounded-full","object-cover",3,"src"],[1,"flex","items-center","justify-center","w-full","h-full","rounded-full","text-lg","uppercase","bg-gray-200","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"z-20","flex","items-center","py-5","px-8","cursor-pointer","border-b",3,"ngClass","click"],[1,"relative","flex","flex-0","items-center","justify-center","w-10","h-10"],[1,"min-w-0","ml-4"],[1,"font-medium","leading-5","truncate"],[1,"leading-5","truncate","text-secondary"],[1,"flex","flex-col","items-end","self-start","ml-auto","pl-2"],[1,"text-sm","leading-5","text-secondary"],[1,"py-0.5","px-3","rounded-full","text-sm","font-semibold","text-blue-800","bg-blue-100","dark:text-blue-50","dark:bg-blue-500"],[1,"absolute","bottom-0","right-0","flex-0","w-2","h-2","-ml-0.5","rounded-full","ring-2","ring-bg-card","dark:ring-gray-900","bg-primary","dark:bg-primary-500","text-on-primary"],["appImgFallback","assets/images/avatars/default.png","alt","Contact avatar",1,"w-full","h-full","rounded-full","object-cover",3,"src"],[1,"icon-size-5","text-hint",3,"svgIcon"],[1,"flex","flex-auto","flex-col","items-center","justify-center","h-full"],[1,"icon-size-24",3,"svgIcon"],[1,"mt-4","text-2xl","font-semibold","tracking-tight","text-secondary"],[1,"flex-auto","border-l",3,"ngClass"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"mat-drawer-container",1),t.TgZ(2,"mat-drawer",2,3),t.NdJ("openedChange",function(c){return i.drawerOpened=c}),t.YNc(4,kt,2,1,"ng-container",4),t.YNc(5,wt,2,1,"ng-container",4),t.qZA(),t.TgZ(6,"mat-drawer-content",5),t.YNc(7,Nt,46,26,"ng-container",6),t.YNc(8,qt,4,1,"ng-template",null,7,t.W1O),t.YNc(10,Ot,3,4,"ng-container",4),t.qZA(),t.qZA(),t.qZA()),2&e){const r=t.MAs(9);t.xp6(1),t.Q6J("hasBackdrop",!1),t.xp6(1),t.Q6J("autoFocus",!1)("opened",i.drawerOpened),t.xp6(2),t.Q6J("ngIf","new-chat"===i.drawerComponent),t.xp6(1),t.Q6J("ngIf","profile"===i.drawerComponent),t.xp6(2),t.Q6J("ngIf",i.tickets.length>0)("ngIfElse",r),t.xp6(3),t.Q6J("ngIf",i.tickets&&i.tickets.length>0)}},directives:[T.kh,T.jA,p.O5,T.LW,vt,Tt,v.lW,k.Hw,b.p6,b.VK,b.OP,C.KE,C.qo,J.Nt,p.mk,p.sg,Zt,h.lC],pipes:[p.uU],encapsulation:2,changeDetection:0}),n})();var R=s(8305),Yt=s(3677);let Ht=(()=>{class n{constructor(e){this.store=e,this.url="http://localhost:8080/",this.onMenssages=()=>R.y.create(i=>{this.socket.on("appMessage",r=>(console.log(r),"create"===r.action?this.store.dispatch((0,Z.Hz)({message:r.message})):"update"===r.action?this.store.dispatch((0,Z.o6)({message:r.message})):void 0))}),this.socket=(0,Yt.io)(this.url)}onEvent(e,i){return new R.y(r=>{this.socket.on(e,()=>r.next()),this.socket.emit("joinChatBox",i)})}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(x.yh))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Rt=s(287);function Et(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",2),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.handleUpdateTicketStatus("open",null==r.user?null:r.user.id)}),t._UZ(1,"mat-icon",3),t.TgZ(2,"span",4),t._uU(3,"Reabrir"),t.qZA(),t.qZA()}2&n&&(t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","mat_solid:refresh"))}function Pt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",2),t.NdJ("click",function(){return t.CHM(e),t.oxw().handleUpdateTicketStatus("pending",null)}),t._UZ(1,"mat-icon",3),t.TgZ(2,"span",4),t._uU(3,"Devolver"),t.qZA(),t.qZA(),t.TgZ(4,"button",2),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.handleUpdateTicketStatus("closed",null==r.user?null:r.user.id)}),t._UZ(5,"mat-icon",3),t.TgZ(6,"span",4),t._uU(7,"Resolver"),t.qZA(),t.qZA(),t.TgZ(8,"button",5),t._UZ(9,"mat-icon",6),t.TgZ(10,"mat-menu",null,7),t.TgZ(12,"button",8),t._UZ(13,"mat-icon",6),t._uU(14," Transferir "),t.qZA(),t.TgZ(15,"button",8),t._UZ(16,"mat-icon",6),t._uU(17," Borrar "),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=t.MAs(11);t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","mat_solid:refresh"),t.xp6(3),t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:check-circle"),t.xp6(3),t.Q6J("matMenuTriggerFor",e),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:dots-vertical"),t.xp6(4),t.Q6J("svgIcon","heroicons_outline:user-circle"),t.xp6(3),t.Q6J("svgIcon","heroicons_outline:trash")}}function Lt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",2),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return r.handleUpdateTicketStatus("open",null==r.user?null:r.user.id)}),t._UZ(1,"mat-icon",3),t.TgZ(2,"span",4),t._uU(3,"Aceptar"),t.qZA(),t.qZA()}2&n&&(t.Q6J("color","primary"),t.xp6(1),t.Q6J("svgIcon","mat_solid:refresh"))}let Wt=(()=>{class n{constructor(e,i,r,c,a){this.toast=e,this._userService=i,this.router=r,this._ticketService=c,this._changeDetectorRef=a,this._unsubscribeAll=new A.x}ngOnInit(){console.log(this.ticket),this._userService.user$.pipe((0,f.R)(this._unsubscribeAll)).subscribe(e=>{this.user=e,this._changeDetectorRef.markForCheck()})}handleUpdateTicketStatus(e,i){this._ticketService.putTicket(this.ticket.id,{status:e,userId:i||null}).subscribe(r=>{r&&("open"===e?this.router.navigateByUrl("/chatwsp/"+this.ticket.id):(this.router.navigateByUrl("/chatwsp/"),this.resetTicket()))},r=>{this.toast.open(r.Message)})}resetTicket(){this._ticketService.resetTicket(),this._changeDetectorRef.markForCheck()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Y.F),t.Y36(U.K),t.Y36(h.F0),t.Y36(S.w),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-ticketactionbuttons"]],inputs:{ticket:"ticket"},decls:4,vars:4,consts:[[3,"ngSwitch"],[3,"ngSwitchCase"],["mat-flat-button","",3,"color","click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2"],["mat-icon-button","",3,"matMenuTriggerFor"],[3,"svgIcon"],["conversationHeaderMenu",""],["mat-menu-item",""]],template:function(e,i){1&e&&(t.ynx(0,0),t.YNc(1,Et,4,2,"ng-template",1),t.YNc(2,Pt,18,8,"ng-template",1),t.YNc(3,Lt,4,2,"ng-template",1),t.BQk()),2&e&&(t.Q6J("ngSwitch",i.ticket.status),t.xp6(1),t.Q6J("ngSwitchCase","closed"),t.xp6(1),t.Q6J("ngSwitchCase","open"),t.xp6(1),t.Q6J("ngSwitchCase","pending"))},directives:[p.RF,p.n9,v.lW,k.Hw,b.p6,b.VK,b.OP],styles:[""],encapsulation:2,changeDetection:0}),n})();const jt=["messageInput"],zt=["scrollOne"],$t=["scrollMe"];function Kt(n,o){if(1&n&&(t.ynx(0),t._UZ(1,"img",29),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("src",e.ticket.contact.avatar,t.LSH)}}function Gt(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",30),t._uU(2),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(2),t.hij(" ",e.ticket.contact.name.charAt(0)," ")}}function Xt(n,o){1&n&&t._UZ(0,"div",null,36)}function Vt(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",37),t._UZ(2,"div",38),t.TgZ(3,"div",39),t._uU(4),t.ALo(5,"date"),t.qZA(),t._UZ(6,"div",38),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(4),t.hij(" ",t.xi3(5,1,e.createdAt,"longDate")," ")}}function te(n,o){1&n&&t.GkF(0)}const ee=function(n,o){return{"color-me -right-1 -mr-px mb-px":n,"text-white -left-1 -ml-px mb-px -scale-x-1":o}};function ne(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",40),t.YNc(2,te,1,0,"ng-container",41),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.oxw(2);const i=t.MAs(5);t.xp6(1),t.Q6J("ngClass",t.WLB(2,ee,e.fromMe,!e.fromMe)),t.xp6(1),t.Q6J("ngTemplateOutlet",i)}}function oe(n,o){if(1&n&&(t.TgZ(0,"div",42),t._UZ(1,"span",43),t.TgZ(2,"div",44),t.TgZ(3,"span",45),t._uU(4),t.qZA(),t._uU(5),t.qZA(),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(4),t.Oqu(null==e.quotedMsg||null==e.quotedMsg.contact?null:e.quotedMsg.contact.name),t.xp6(1),t.hij(" ",e.quotedMsg.body," ")}}function ie(n,o){if(1&n&&(t.TgZ(0,"div",46),t.TgZ(1,"div",47),t._UZ(2,"img",48),t.qZA(),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("src",e.mediaUrl,t.LSH)}}const re=function(n,o){return{"mr-0":n,"ml-3":o}};function ce(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",49),t._uU(2),t.ALo(3,"date"),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngClass",t.WLB(5,re,e.fromMe,!e.fromMe)),t.xp6(1),t.hij(" ",t.xi3(3,2,e.createdAt,"HH:mm")," ")}}const se=function(n,o,e,i){return{"items-end":n,"items-start":o,"mt-0.5":e,"mt-3":i}},ae=function(n,o){return{"msg-me color-wsp{":n,"bg-white color-wsp{":o}};function le(n,o){if(1&n&&(t.ynx(0),t.YNc(1,Xt,2,0,"div",13),t.YNc(2,Vt,7,4,"ng-container",13),t.ALo(3,"date"),t.ALo(4,"date"),t.TgZ(5,"div",31),t.TgZ(6,"div",32),t.YNc(7,ne,3,5,"ng-container",13),t.YNc(8,oe,6,2,"div",33),t.YNc(9,ie,3,1,"div",34),t._UZ(10,"div",35),t.YNc(11,ce,4,8,"ng-container",13),t.qZA(),t.qZA(),t.BQk()),2&n){const e=o.$implicit,i=o.index,r=o.first,c=o.last,a=t.oxw(2);t.xp6(1),t.Q6J("ngIf",i==a.messages.length-1),t.xp6(1),t.Q6J("ngIf",r||t.xi3(3,9,a.messages[i-1].createdAt,"d")!==t.xi3(4,12,e.createdAt,"d")),t.xp6(3),t.Q6J("ngClass",t.l5B(15,se,e.fromMe,!e.fromMe,i>0&&a.messages[i-1].fromMe===e.fromMe,i>0&&a.messages[i-1].fromMe!==e.fromMe)),t.xp6(1),t.Q6J("ngClass",t.WLB(20,ae,e.fromMe,!e.fromMe)),t.xp6(1),t.Q6J("ngIf",c||a.messages[i+1].fromMe!==e.fromMe),t.xp6(1),t.Q6J("ngIf",e.quotedMsg),t.xp6(1),t.Q6J("ngIf","image"==e.mediaType),t.xp6(1),t.Q6J("innerHTML",e.body,t.oJD),t.xp6(1),t.Q6J("ngIf",r||c||a.messages[i+1].fromMe!==e.fromMe||a.messages[i+1].createdAt!==e.createdAt)}}const ue=function(){return["./"]};function pe(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"mat-drawer-container",4),t.TgZ(2,"mat-drawer",5,6),t.NdJ("openedChange",function(r){return t.CHM(e),t.oxw().drawerOpened=r}),t.qZA(),t.TgZ(4,"mat-drawer-content",7),t.TgZ(5,"div",8),t.TgZ(6,"a",9),t.NdJ("click",function(){return t.CHM(e),t.oxw().resetChat()}),t._UZ(7,"mat-icon",10),t.qZA(),t.TgZ(8,"div",11),t.NdJ("click",function(){return t.CHM(e),t.oxw().openContactInfo()}),t.TgZ(9,"div",12),t.YNc(10,Kt,2,1,"ng-container",13),t.YNc(11,Gt,3,1,"ng-container",13),t.qZA(),t.TgZ(12,"div",14),t._uU(13),t.qZA(),t.qZA(),t._UZ(14,"app-ticketactionbuttons",15),t.qZA(),t.TgZ(15,"div",16),t.TgZ(16,"div",17),t.NdJ("scroll",function(r){return t.CHM(e),t.oxw().doSomethingOnScroll(r)}),t.YNc(17,le,12,23,"ng-container",18),t.qZA(),t.qZA(),t.TgZ(18,"div",19),t.TgZ(19,"div",20),t.TgZ(20,"button",21),t._UZ(21,"mat-icon",10),t.qZA(),t.TgZ(22,"button",22),t._UZ(23,"mat-icon",10),t.qZA(),t.qZA(),t.TgZ(24,"mat-form-field",23),t._UZ(25,"textarea",24,25),t.qZA(),t.TgZ(27,"div",26),t.TgZ(28,"button",27),t.NdJ("click",function(){return t.CHM(e),t.oxw().nextPage()}),t._UZ(29,"mat-icon",28),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("hasBackdrop",!1),t.xp6(1),t.Q6J("autoFocus",!1)("mode",e.drawerMode)("position","end")("opened",e.drawerOpened),t.xp6(4),t.Q6J("routerLink",t.DdM(17,ue)),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:arrow-narrow-left"),t.xp6(3),t.Q6J("ngIf",e.ticket.contact.avatar),t.xp6(1),t.Q6J("ngIf",!e.ticket.contact.avatar),t.xp6(2),t.Oqu(e.ticket.contact.name),t.xp6(1),t.Q6J("ticket",e.ticket),t.xp6(3),t.Q6J("ngForOf",e.messages)("ngForTrackBy",e.trackByFn),t.xp6(4),t.Q6J("svgIcon","heroicons_outline:emoji-happy"),t.xp6(2),t.Q6J("svgIcon","heroicons_outline:paper-clip"),t.xp6(2),t.Q6J("rows",1),t.xp6(4),t.Q6J("svgIcon","heroicons_outline:paper-airplane")}}function ge(n,o){1&n&&(t.TgZ(0,"div",50),t._UZ(1,"mat-icon",51),t.TgZ(2,"div",52),t._uU(3,"Selecciona un ticket para empezar a chatear."),t.qZA(),t.qZA()),2&n&&(t.xp6(1),t.Q6J("svgIcon","heroicons_outline:chat"))}function fe(n,o){1&n&&(t.O4$(),t.TgZ(0,"svg",53),t.TgZ(1,"g",54),t._UZ(2,"path",55),t.qZA(),t.qZA())}let de=(()=>{class n{constructor(e,i,r,c,a,l,m){this.store=e,this._ticketService=i,this._changeDetectorRef=r,this._chatService=c,this._ticketMessagesSocketService=a,this._fuseMediaWatcherService=l,this._ngZone=m,this.drawerMode="side",this.drawerOpened=!1,this._unsubscribeAll=new A.x,this.page=1,this.hasMore=!1}_resizeMessageInput(){this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.messageInput.nativeElement.style.height="auto",this._changeDetectorRef.detectChanges(),this.messageInput.nativeElement.style.height=`${this.messageInput.nativeElement.scrollHeight}px`,this._changeDetectorRef.detectChanges()})})}ngOnInit(){this.store.select(ut).subscribe(e=>{this.messages=e,setTimeout(()=>{1===this.page&&e.length>1&&this.scrollToBottom()},0),this._changeDetectorRef.markForCheck()}),this._ticketService.ticket$.pipe((0,f.R)(this._unsubscribeAll)).subscribe(e=>{e&&(this._ticketMessagesSocketService.onEvent("connect",e.id.toString()).subscribe(()=>{console.log("Connected to the server v2")}),this._ticketMessagesSocketService.onMenssages().subscribe()),this.ticket=e,this._changeDetectorRef.markForCheck()}),this._chatService.chat$.pipe((0,f.R)(this._unsubscribeAll)).subscribe(e=>{this.chat=e,this._changeDetectorRef.markForCheck()}),this._fuseMediaWatcherService.onMediaChange$.pipe((0,f.R)(this._unsubscribeAll)).subscribe(({matchingAliases:e})=>{this.drawerMode=e.includes("lg")?"side":"over",this._changeDetectorRef.markForCheck()})}doSomethingOnScroll(e){const i=e.srcElement.scrollTop;if(0===i){if(!this.myScrollOne)return;this.myScrollOne.nativeElement.scrollTop=1}i<250&&this.nextPage(),this._changeDetectorRef.markForCheck()}nextPage(){this.page++,this.store.dispatch((0,Z.EV)({id:this.ticket.id.toString(),payload:{pageNumber:this.page}}))}scrollToBottom(){this.myScrollContainer.nativeElement.scrollIntoView(),this._changeDetectorRef.markForCheck()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}openContactInfo(){this.drawerOpened=!0,this._changeDetectorRef.markForCheck()}resetChat(){this._chatService.resetChat(),this.drawerOpened=!1,this._changeDetectorRef.markForCheck()}toggleMuteNotifications(){this.chat.muted=!this.chat.muted,this._chatService.updateChat(this.chat.id,this.chat).subscribe()}trackByFn(e,i){return i.id||e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(x.yh),t.Y36(S.w),t.Y36(t.sBO),t.Y36(_),t.Y36(Ht),t.Y36(Rt.T),t.Y36(t.R0b))},n.\u0275cmp=t.Xpm({type:n,selectors:[["chat-conversation"]],viewQuery:function(e,i){if(1&e&&(t.Gf(jt,5),t.Gf(zt,5),t.Gf($t,5)),2&e){let r;t.iGM(r=t.CRH())&&(i.messageInput=r.first),t.iGM(r=t.CRH())&&(i.myScrollOne=r.first),t.iGM(r=t.CRH())&&(i.myScrollContainer=r.first)}},hostBindings:function(e,i){1&e&&t.NdJ("input",function(){return i._resizeMessageInput()})("ngModelChange",function(){return i._resizeMessageInput()})},decls:6,vars:2,consts:[[1,"flex","flex-col","flex-auto","overflow-y-auto","lg:overflow-hidden","bg-card","dark:bg-default"],[4,"ngIf","ngIfElse"],["selectChatOrStartNew",""],["speechBubbleExtension",""],[1,"flex-auto","h-full",3,"hasBackdrop"],[1,"w-full","sm:w-100","lg:border-l","lg:shadow-none","dark:bg-gray-900",3,"autoFocus","mode","position","opened","openedChange"],["drawer",""],[1,"flex","flex-col","overflow-hidden"],[1,"flex","flex-0","items-center","h-18","px-4","md:px-6","border-b","bg-gray-50","dark:bg-transparent"],["mat-icon-button","",1,"lg:hidden","md:-ml-2",3,"routerLink","click"],[3,"svgIcon"],[1,"flex","items-center","ml-2","lg:ml-0","mr-2","cursor-pointer",3,"click"],[1,"relative","flex","flex-0","items-center","justify-center","w-10","h-10"],[4,"ngIf"],[1,"ml-4","text-lg","font-medium","leading-5","truncate"],[1,"ml-auto","space-x-3",3,"ticket"],[1,"container-messages"],[1,"p-6","bg-card","shrink","bg-wsp","dark:bg-transparent",3,"scroll"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-end","p-4","border-t","bg-gray-50","dark:bg-transparent"],[1,"flex","items-center","h-11","my-px"],["mat-icon-button",""],["mat-icon-button","",1,"ml-0.5"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","fuse-mat-bold","w-full","ml-4"],["matInput","","placeholder","Escriba un mensaje o presiones '/' para usar las respuestas r\xe1pidas registradas",1,"min-h-5","my-0","resize-none",2,"margin","11px 0 !important","padding","0 !important",3,"rows"],["messageInput",""],[1,"flex","items-center","h-11","my-px","ml-4"],["mat-icon-button","",3,"click"],[1,"transform","rotate-90",3,"svgIcon"],["alt","Contact avatar",1,"w-full","h-full","rounded-full","object-cover",3,"src"],[1,"flex","items-center","justify-center","w-full","h-full","rounded-full","text-lg","uppercase","bg-gray-200","text-gray-600","dark:bg-gray-700","dark:text-gray-200"],[1,"flex","flex-col",3,"ngClass"],[1,"relative","max-w-3/4","px-3","py-2","rounded-lg",3,"ngClass"],["class","makeStyles-quotedContainerLeft-78",4,"ngIf"],["class","flex flex-col rounded overflow-hidden border",4,"ngIf"],[1,"min-w-4","leading-5",2,"padding","3px 80px 6px 6px",3,"innerHTML"],["scrollMe",""],[1,"flex","items-center","justify-center","my-3","-mx-6"],[1,"flex-auto","border-b"],[1,"flex-0","mx-4","text-sm","font-medium","leading-5","text-secondary"],[1,"absolute","bottom-0","w-3","transform",3,"ngClass"],[4,"ngTemplateOutlet"],[1,"makeStyles-quotedContainerLeft-78"],[1,"makeStyles-quotedSideColorLeft-80"],[1,"makeStyles-quotedMsg-79"],[1,"makeStyles-messageContactName-86"],[1,"flex","flex-col","rounded","overflow-hidden","border"],[1,"flex"],["alt","Card cover image",1,"w-50","h-50","rounded","object-cover",3,"src"],[1,"my-0.5",2,"color","#999","right","5px","bottom","0","position","absolute","font-size","11px",3,"ngClass"],[1,"flex","flex-col","flex-auto","items-center","justify-center","bg-gray-100","dark:bg-transparent"],[1,"icon-size-24",3,"svgIcon"],[1,"mt-4","text-2xl","font-semibold","tracking-tight","text-secondary"],["width","100%","height","100%","viewBox","0 0 66 66","xmlns","http://www.w3.org/2000/svg"],["id","Page-1","stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["d","M1.01522827,0.516204834 C-8.83532715,54.3062744 61.7609863,70.5215302 64.8009949,64.3061218 C68.8074951,54.8859711 30.1663208,52.9997559 37.5036011,0.516204834 L1.01522827,0.516204834 Z","fill","currentColor","fill-rule","nonzero"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0),t.YNc(1,pe,30,18,"ng-container",1),t.YNc(2,ge,4,1,"ng-template",null,2,t.W1O),t.YNc(4,fe,3,0,"ng-template",null,3,t.W1O),t.qZA()),2&e){const r=t.MAs(3);t.xp6(1),t.Q6J("ngIf",i.ticket)("ngIfElse",r)}},directives:[p.O5,T.kh,T.jA,T.LW,v.zs,h.yS,k.Hw,Wt,p.sg,v.lW,C.KE,J.Nt,p.mk,p.tP],pipes:[p.uU],styles:[".container-messages{display:flex;overflow:hidden;position:relative;flex-grow:1;flex-direction:column}.makeStyles-quotedContainerLeft-78{margin:-3px 0 6px -6px;display:flex;overflow:hidden;position:relative;border-radius:7.5px;background-color:#f0f0f0}.makeStyles-quotedSideColorLeft-80{flex:none;width:4px;background-color:#6bcbef}.makeStyles-quotedMsg-79{height:auto;display:block;padding:10px;overflow:hidden;max-width:300px;white-space:pre-wrap}.makeStyles-messageContactName-86{color:#6bcbef;display:flex;font-weight:500}.bg-wsp{display:flex;padding:20px;flex-grow:1;overflow-y:scroll;flex-direction:column;background-image:url(wa-background.0afeabfc95769b00.png)!important}.msg-me{background-color:#dcf8c6}.color-me{color:#dcf8c6}.color-wsp{color:#303030}\n"],encapsulation:2,changeDetection:0}),n})();const me=[{path:"",component:at,resolve:{chats:it,contacts:ct,profile:st},children:[{path:"",component:Bt,children:[{path:"",pathMatch:"full",component:s(9559).y},{path:":id",component:de,resolve:{conversation:rt}}]}]}];var _e=s(2605);let Ye=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[],imports:[[]]}),n})(),He=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({}),n})(),Re=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[h.Bz.forChild(me),v.ot,X.p9,C.lN,_e.Nh,k.Ps,Ye,He,J.c,b.Tx,T.SJ,V.m]]}),n})()}}]);